
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Title2</title>
<link rel="stylesheet" href="https://stackedit.io/res-min/themes/base.css" />
<script type="text/javascript" src="https://stackedit.io/libs/MathJax/MathJax.js?config=TeX-AMS_HTML"></script>
</head>
<body><div class="container"><h1 id="programming-exercise-1-linear-regression">Programming Exercise 1: Linear Regression</h1>

<h3 id="1-simple-octave-function">1. Simple octave function</h3>

<h4 id="create-a-5-x-5-identity-matrix">create a 5 x 5 identity matrix</h4>

<pre class="prettyprint prettyprinted"><code class="language-matlab"><span class="pln">A </span><span class="pun">=</span><span class="pln"> eye</span><span class="pun">(</span><span class="lit">5</span><span class="pun">);</span></code></pre>

<h3 id="2-linear-regression-with-one-variable">2. Linear regression with one variable</h3>

<p>In this part of this exercise, you will implement linear regression with one variable to predict profits for a food truck.</p>

<p>The file <code>ex1data1.txt</code> contains the dataset for our linear regression problem. The first column is the population of a city and the second column is the profit of a food truck in that city. A negative value for profit indicates a loss. It looks like:</p>

<pre class="prettyprint prettyprinted"><code><span class="lit">6.1101</span><span class="pun">,</span><span class="lit">17.592</span><span class="pln">
</span><span class="lit">5.5277</span><span class="pun">,</span><span class="lit">9.1302</span><span class="pln">
</span><span class="lit">8.5186</span><span class="pun">,</span><span class="lit">13.662</span><span class="pln">
</span><span class="lit">7.0032</span><span class="pun">,</span><span class="lit">11.854</span></code></pre>

<h3 id="21-plotting-the-data">2.1 Plotting the Data</h3>

<h4 id="load-the-dataset-from-data-file-into-the-variables-x-and-y">load the dataset from data file into the variables <code>X</code> and <code>y</code></h4>

<pre class="prettyprint prettyprinted"><code class="language-matlab"><span class="pln">data </span><span class="pun">=</span><span class="pln"> load</span><span class="pun">(</span><span class="str">'ex1data1.txt'</span><span class="pun">);</span><span class="pln">    </span><span class="pun">%</span><span class="pln"> read comma separated data
X </span><span class="pun">=</span><span class="pln"> data</span><span class="pun">(:,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln"> y </span><span class="pun">=</span><span class="pln"> data</span><span class="pun">(:,</span><span class="pln"> </span><span class="lit">2</span><span class="pun">);</span><span class="pln">
m </span><span class="pun">=</span><span class="pln"> length</span><span class="pun">(</span><span class="pln">y</span><span class="pun">);</span><span class="pln">                  </span><span class="pun">%</span><span class="pln"> number of training examples</span></code></pre>

<h4 id="create-a-scatter-plot-of-the-data">create a scatter plot of the data</h4>

<pre class="prettyprint prettyprinted"><code class="language-matlab"><span class="pln">plot</span><span class="pun">(</span><span class="pln">x</span><span class="pun">,</span><span class="pln"> y</span><span class="pun">,</span><span class="pln"> </span><span class="str">'rx'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'MarkerSize'</span><span class="pun">,</span><span class="pln"> </span><span class="lit">10</span><span class="pun">);</span><span class="pln">         </span><span class="pun">%</span><span class="pln"> </span><span class="typ">Plot</span><span class="pln"> the data
ylabel</span><span class="pun">(</span><span class="str">'Profit in $10,000s'</span><span class="pun">);</span><span class="pln">              </span><span class="pun">%</span><span class="pln"> </span><span class="typ">Set</span><span class="pln"> the y</span><span class="pun">-</span><span class="pln">axis label
xlabel</span><span class="pun">(</span><span class="str">'Population of City in 10,000s'</span><span class="pun">);</span><span class="pln">    </span><span class="pun">%</span><span class="pln"> </span><span class="typ">Set</span><span class="pln"> the x</span><span class="pun">-</span><span class="pln">axis label</span></code></pre>

<ul>
<li><code>rx</code>: change the marker to red <code>x</code></li>
</ul>

<h3 id="22-gradient-descent">2.2 Gradient Descent</h3>

<p>The objective of linear regression is to minimize the cost function: <span class="MathJax_Preview"></span><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-1-Frame"><nobr><span class="math" id="MathJax-Span-1" style="width: 16.945em; display: inline-block;"><span style="display: inline-block; position: relative; width: 13.994em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.475em 1000.003em 3.545em -0.469em); top: -2.181em; left: 0.003em;"><span class="mrow" id="MathJax-Span-2"><span class="mi" id="MathJax-Span-3" style="font-family: MathJax_Math; font-style: italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.062em;"></span></span><span class="mo" id="MathJax-Span-4" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-5" style="font-family: MathJax_Math; font-style: italic;">θ</span><span class="mo" id="MathJax-Span-6" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-7" style="font-family: MathJax_Main; padding-left: 0.298em;">=</span><span class="mfrac" id="MathJax-Span-8" style="padding-left: 0.416em; padding-right: 0.121em;"><span style="display: inline-block; position: relative; width: 1.538em; height: 0px;"><span style="position: absolute; clip: rect(1.361em 1000.003em 2.364em -0.469em); top: -2.831em; left: 50%; margin-left: -0.233em;"><span class="mn" id="MathJax-Span-9" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.187em;"></span></span><span style="position: absolute; clip: rect(1.361em 1000.003em 2.364em -0.469em); top: -1.473em; left: 50%; margin-left: -0.705em;"><span class="mrow" id="MathJax-Span-10"><span class="mn" id="MathJax-Span-11" style="font-family: MathJax_Main;">2</span><span class="mi" id="MathJax-Span-12" style="font-family: MathJax_Math; font-style: italic;">m</span></span><span style="display: inline-block; width: 0px; height: 2.187em;"></span></span><span style="position: absolute; clip: rect(0.829em 1000.003em 1.243em -0.528em); top: -1.296em; left: 0.003em;"><span style="border-left-width: 1.538em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.003em;"></span><span style="display: inline-block; width: 0px; height: 1.066em;"></span></span></span></span><span class="munderover" id="MathJax-Span-13" style="padding-left: 0.18em;"><span style="display: inline-block; position: relative; width: 1.479em; height: 0px;"><span style="position: absolute; clip: rect(2.069em 1000.003em 3.84em -0.469em); top: -3.185em; left: 0.003em;"><span class="mo" id="MathJax-Span-14" style="font-family: MathJax_Size2; vertical-align: 0.003em;">∑</span><span style="display: inline-block; width: 0px; height: 3.191em;"></span></span><span style="position: absolute; clip: rect(1.479em 1000.003em 2.423em -0.528em); top: -1.06em; left: 0.18em;"><span class="texatom" id="MathJax-Span-15"><span class="mrow" id="MathJax-Span-16"><span class="mi" id="MathJax-Span-17" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-18" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-19" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.128em;"></span></span><span style="position: absolute; clip: rect(1.538em 1000.003em 2.305em -0.528em); top: -3.244em; left: 0.416em;"><span class="texatom" id="MathJax-Span-20"><span class="mrow" id="MathJax-Span-21"><span class="mi" id="MathJax-Span-22" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">m</span></span></span><span style="display: inline-block; width: 0px; height: 2.128em;"></span></span></span></span><span class="mo" id="MathJax-Span-23" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-24"><span style="display: inline-block; position: relative; width: 1.006em; height: 0px;"><span style="position: absolute; clip: rect(1.243em 1000.003em 2.305em -0.469em); top: -2.122em; left: 0.003em;"><span class="mi" id="MathJax-Span-25" style="font-family: MathJax_Math; font-style: italic;">h</span><span style="display: inline-block; width: 0px; height: 2.128em;"></span></span><span style="position: absolute; top: -1.945em; left: 0.593em;"><span class="texatom" id="MathJax-Span-26"><span class="mrow" id="MathJax-Span-27"><span class="mi" id="MathJax-Span-28" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 2.128em;"></span></span></span></span><span class="mo" id="MathJax-Span-29" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-30"><span style="display: inline-block; position: relative; width: 1.479em; height: 0px;"><span style="position: absolute; clip: rect(1.538em 1000.003em 2.305em -0.469em); top: -2.122em; left: 0.003em;"><span class="mi" id="MathJax-Span-31" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.128em;"></span></span><span style="position: absolute; top: -2.535em; left: 0.593em;"><span class="texatom" id="MathJax-Span-32"><span class="mrow" id="MathJax-Span-33"><span class="mo" id="MathJax-Span-34" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-35" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-36" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.128em;"></span></span></span></span><span class="mo" id="MathJax-Span-37" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-38" style="font-family: MathJax_Main; padding-left: 0.239em;">−</span><span class="msubsup" id="MathJax-Span-39" style="padding-left: 0.239em;"><span style="display: inline-block; position: relative; width: 1.479em; height: 0px;"><span style="position: absolute; clip: rect(1.538em 1000.003em 2.482em -0.528em); top: -2.122em; left: 0.003em;"><span class="mi" id="MathJax-Span-40" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.128em;"></span></span><span style="position: absolute; top: -2.535em; left: 0.593em;"><span class="texatom" id="MathJax-Span-41"><span class="mrow" id="MathJax-Span-42"><span class="mo" id="MathJax-Span-43" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-44" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-45" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.128em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-46"><span style="display: inline-block; position: relative; width: 0.829em; height: 0px;"><span style="position: absolute; clip: rect(1.243em 1000.003em 2.6em -0.469em); top: -2.181em; left: 0.003em;"><span class="mo" id="MathJax-Span-47" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 2.187em;"></span></span><span style="position: absolute; top: -2.594em; left: 0.416em;"><span class="mn" id="MathJax-Span-48" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.128em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.187em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 3.504em; vertical-align: -1.496em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-1"> J(\theta) = \frac{1}{2m}\sum_{i=1}^{m}(h_{\theta}(x^{(i)})-y^{(i)})^2 </script> where the hypothesis is given by the linear model <span class="MathJax_Preview"></span><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-2-Frame"><nobr><span class="math" id="MathJax-Span-49" style="width: 12.577em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.393em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.125em 1000.003em 2.6em -0.469em); top: -2.181em; left: 0.003em;"><span class="mrow" id="MathJax-Span-50"><span class="msubsup" id="MathJax-Span-51"><span style="display: inline-block; position: relative; width: 1.006em; height: 0px;"><span style="position: absolute; clip: rect(1.243em 1000.003em 2.305em -0.469em); top: -2.122em; left: 0.003em;"><span class="mi" id="MathJax-Span-52" style="font-family: MathJax_Math; font-style: italic;">h</span><span style="display: inline-block; width: 0px; height: 2.128em;"></span></span><span style="position: absolute; top: -1.945em; left: 0.593em;"><span class="texatom" id="MathJax-Span-53"><span class="mrow" id="MathJax-Span-54"><span class="mi" id="MathJax-Span-55" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 2.128em;"></span></span></span></span><span class="mo" id="MathJax-Span-56" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-57" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-58" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-59" style="font-family: MathJax_Main; padding-left: 0.298em;">=</span><span class="msubsup" id="MathJax-Span-60" style="padding-left: 0.298em;"><span style="display: inline-block; position: relative; width: 1.006em; height: 0px;"><span style="position: absolute; clip: rect(1.243em 1000.003em 2.305em -0.469em); top: -2.122em; left: 0.003em;"><span class="mi" id="MathJax-Span-61" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 2.128em;"></span></span><span style="position: absolute; top: -2.535em; left: 0.475em;"><span class="texatom" id="MathJax-Span-62"><span class="mrow" id="MathJax-Span-63"><span class="mi" id="MathJax-Span-64" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.062em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.128em;"></span></span></span></span><span class="mi" id="MathJax-Span-65" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-66" style="font-family: MathJax_Main; padding-left: 0.298em;">=</span><span class="msubsup" id="MathJax-Span-67" style="padding-left: 0.298em;"><span style="display: inline-block; position: relative; width: 0.888em; height: 0px;"><span style="position: absolute; clip: rect(1.243em 1000.003em 2.305em -0.469em); top: -2.122em; left: 0.003em;"><span class="mi" id="MathJax-Span-68" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 2.128em;"></span></span><span style="position: absolute; top: -1.945em; left: 0.475em;"><span class="texatom" id="MathJax-Span-69"><span class="mrow" id="MathJax-Span-70"><span class="mn" id="MathJax-Span-71" style="font-size: 70.7%; font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 2.128em;"></span></span></span></span><span class="mo" id="MathJax-Span-72" style="font-family: MathJax_Main; padding-left: 0.239em;">+</span><span class="msubsup" id="MathJax-Span-73" style="padding-left: 0.239em;"><span style="display: inline-block; position: relative; width: 0.888em; height: 0px;"><span style="position: absolute; clip: rect(1.243em 1000.003em 2.305em -0.469em); top: -2.122em; left: 0.003em;"><span class="mi" id="MathJax-Span-74" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 2.128em;"></span></span><span style="position: absolute; top: -1.945em; left: 0.475em;"><span class="texatom" id="MathJax-Span-75"><span class="mrow" id="MathJax-Span-76"><span class="mn" id="MathJax-Span-77" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.128em;"></span></span></span></span><span class="mi" id="MathJax-Span-78" style="font-family: MathJax_Math; font-style: italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.187em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.575em; vertical-align: -0.354em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-2"> h_{\theta}(x)=\theta^{T}x=\theta_{0}+\theta_{1}x </script></p>

<p>The parameters of your model are the <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-79" style="width: 1.066em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.888em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.243em 1000.003em 2.6em -0.469em); top: -2.122em; left: 0.003em;"><span class="mrow" id="MathJax-Span-80"><span class="msubsup" id="MathJax-Span-81"><span style="display: inline-block; position: relative; width: 0.829em; height: 0px;"><span style="position: absolute; clip: rect(1.243em 1000.003em 2.305em -0.469em); top: -2.122em; left: 0.003em;"><span class="mi" id="MathJax-Span-82" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 2.128em;"></span></span><span style="position: absolute; top: -1.945em; left: 0.475em;"><span class="texatom" id="MathJax-Span-83"><span class="mrow" id="MathJax-Span-84"><span class="mi" id="MathJax-Span-85" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span></span></span><span style="display: inline-block; width: 0px; height: 2.128em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.128em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.361em; vertical-align: -0.425em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3">\theta_{j}</script> values. These are the values you will adjust to minimize cost <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-86" style="width: 2.364em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.951em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.243em 1000.003em 2.6em -0.469em); top: -2.181em; left: 0.003em;"><span class="mrow" id="MathJax-Span-87"><span class="mi" id="MathJax-Span-88" style="font-family: MathJax_Math; font-style: italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.062em;"></span></span><span class="mo" id="MathJax-Span-89" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-90" style="font-family: MathJax_Math; font-style: italic;">θ</span><span class="mo" id="MathJax-Span-91" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.187em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.361em; vertical-align: -0.354em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4">J(\theta)</script>. One way to do this is to use the batch gradient descent algorithm. In batch gradient descent, each iteration performs the update simultaneously for all j <span class="MathJax_Preview"></span><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-5-Frame"><nobr><span class="math" id="MathJax-Span-92" style="width: 20.192em; display: inline-block;"><span style="display: inline-block; position: relative; width: 16.65em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.475em 1000.003em 3.545em -0.469em); top: -2.181em; left: 0.003em;"><span class="mrow" id="MathJax-Span-93"><span class="msubsup" id="MathJax-Span-94"><span style="display: inline-block; position: relative; width: 0.829em; height: 0px;"><span style="position: absolute; clip: rect(1.243em 1000.003em 2.305em -0.469em); top: -2.122em; left: 0.003em;"><span class="mi" id="MathJax-Span-95" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 2.128em;"></span></span><span style="position: absolute; top: -1.945em; left: 0.475em;"><span class="texatom" id="MathJax-Span-96"><span class="mrow" id="MathJax-Span-97"><span class="mi" id="MathJax-Span-98" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span></span></span><span style="display: inline-block; width: 0px; height: 2.128em;"></span></span></span></span><span class="mo" id="MathJax-Span-99" style="font-family: MathJax_Main; padding-left: 0.298em;">:<span style="font-family: MathJax_Main; font-style: normal; font-weight: normal;">=</span></span><span class="msubsup" id="MathJax-Span-100" style="padding-left: 0.298em;"><span style="display: inline-block; position: relative; width: 0.829em; height: 0px;"><span style="position: absolute; clip: rect(1.243em 1000.003em 2.305em -0.469em); top: -2.122em; left: 0.003em;"><span class="mi" id="MathJax-Span-101" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 2.128em;"></span></span><span style="position: absolute; top: -1.945em; left: 0.475em;"><span class="texatom" id="MathJax-Span-102"><span class="mrow" id="MathJax-Span-103"><span class="mi" id="MathJax-Span-104" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span></span></span><span style="display: inline-block; width: 0px; height: 2.128em;"></span></span></span></span><span class="mo" id="MathJax-Span-105" style="font-family: MathJax_Main; padding-left: 0.239em;">−</span><span class="mi" id="MathJax-Span-106" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.239em;">α</span><span class="mfrac" id="MathJax-Span-107" style="padding-left: 0.298em; padding-right: 0.121em;"><span style="display: inline-block; position: relative; width: 1.006em; height: 0px;"><span style="position: absolute; clip: rect(1.361em 1000.003em 2.364em -0.469em); top: -2.831em; left: 50%; margin-left: -0.233em;"><span class="mn" id="MathJax-Span-108" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.187em;"></span></span><span style="position: absolute; clip: rect(1.538em 1000.003em 2.305em -0.528em); top: -1.414em; left: 50%; margin-left: -0.41em;"><span class="mi" id="MathJax-Span-109" style="font-family: MathJax_Math; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 2.128em;"></span></span><span style="position: absolute; clip: rect(0.829em 1000.003em 1.243em -0.528em); top: -1.296em; left: 0.003em;"><span style="border-left-width: 1.006em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.003em;"></span><span style="display: inline-block; width: 0px; height: 1.066em;"></span></span></span></span><span class="munderover" id="MathJax-Span-110" style="padding-left: 0.18em;"><span style="display: inline-block; position: relative; width: 1.479em; height: 0px;"><span style="position: absolute; clip: rect(2.069em 1000.003em 3.84em -0.469em); top: -3.185em; left: 0.003em;"><span class="mo" id="MathJax-Span-111" style="font-family: MathJax_Size2; vertical-align: 0.003em;">∑</span><span style="display: inline-block; width: 0px; height: 3.191em;"></span></span><span style="position: absolute; clip: rect(1.479em 1000.003em 2.423em -0.528em); top: -1.06em; left: 0.18em;"><span class="texatom" id="MathJax-Span-112"><span class="mrow" id="MathJax-Span-113"><span class="mi" id="MathJax-Span-114" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-115" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-116" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.128em;"></span></span><span style="position: absolute; clip: rect(1.538em 1000.003em 2.305em -0.528em); top: -3.244em; left: 0.416em;"><span class="texatom" id="MathJax-Span-117"><span class="mrow" id="MathJax-Span-118"><span class="mi" id="MathJax-Span-119" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">m</span></span></span><span style="display: inline-block; width: 0px; height: 2.128em;"></span></span></span></span><span class="mo" id="MathJax-Span-120" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-121"><span style="display: inline-block; position: relative; width: 1.006em; height: 0px;"><span style="position: absolute; clip: rect(1.243em 1000.003em 2.305em -0.469em); top: -2.122em; left: 0.003em;"><span class="mi" id="MathJax-Span-122" style="font-family: MathJax_Math; font-style: italic;">h</span><span style="display: inline-block; width: 0px; height: 2.128em;"></span></span><span style="position: absolute; top: -1.945em; left: 0.593em;"><span class="texatom" id="MathJax-Span-123"><span class="mrow" id="MathJax-Span-124"><span class="mi" id="MathJax-Span-125" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 2.128em;"></span></span></span></span><span class="mo" id="MathJax-Span-126" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-127"><span style="display: inline-block; position: relative; width: 1.479em; height: 0px;"><span style="position: absolute; clip: rect(1.538em 1000.003em 2.305em -0.469em); top: -2.122em; left: 0.003em;"><span class="mi" id="MathJax-Span-128" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.128em;"></span></span><span style="position: absolute; top: -2.535em; left: 0.593em;"><span class="texatom" id="MathJax-Span-129"><span class="mrow" id="MathJax-Span-130"><span class="mo" id="MathJax-Span-131" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-132" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-133" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.128em;"></span></span></span></span><span class="mo" id="MathJax-Span-134" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-135" style="font-family: MathJax_Main; padding-left: 0.239em;">−</span><span class="msubsup" id="MathJax-Span-136" style="padding-left: 0.239em;"><span style="display: inline-block; position: relative; width: 1.479em; height: 0px;"><span style="position: absolute; clip: rect(1.538em 1000.003em 2.482em -0.528em); top: -2.122em; left: 0.003em;"><span class="mi" id="MathJax-Span-137" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.128em;"></span></span><span style="position: absolute; top: -2.535em; left: 0.593em;"><span class="texatom" id="MathJax-Span-138"><span class="mrow" id="MathJax-Span-139"><span class="mo" id="MathJax-Span-140" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-141" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-142" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.128em;"></span></span></span></span><span class="mo" id="MathJax-Span-143" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-144"><span style="display: inline-block; position: relative; width: 1.479em; height: 0px;"><span style="position: absolute; clip: rect(1.538em 1000.003em 2.305em -0.469em); top: -2.122em; left: 0.003em;"><span class="mi" id="MathJax-Span-145" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.128em;"></span></span><span style="position: absolute; clip: rect(1.42em 1000.003em 2.482em -0.469em); top: -2.653em; left: 0.593em;"><span class="texatom" id="MathJax-Span-146"><span class="mrow" id="MathJax-Span-147"><span class="mo" id="MathJax-Span-148" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-149" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-150" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.128em;"></span></span><span style="position: absolute; clip: rect(1.479em 1000.003em 2.423em -0.528em); top: -1.827em; left: 0.593em;"><span class="texatom" id="MathJax-Span-151"><span class="mrow" id="MathJax-Span-152"><span class="mi" id="MathJax-Span-153" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span></span></span><span style="display: inline-block; width: 0px; height: 2.128em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.187em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 3.504em; vertical-align: -1.496em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-5"> \theta_{j}:=\theta_{j}-\alpha\frac{1}{m}\sum_{i=1}^{m}(h_{\theta}(x^{(i)})-y^{(i)})x_{j}^{(i)} </script></p>

<p>With each step of gradient descent, your parameters <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-6-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-154" style="width: 1.066em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.888em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.243em 1000.003em 2.6em -0.469em); top: -2.122em; left: 0.003em;"><span class="mrow" id="MathJax-Span-155"><span class="msubsup" id="MathJax-Span-156"><span style="display: inline-block; position: relative; width: 0.829em; height: 0px;"><span style="position: absolute; clip: rect(1.243em 1000.003em 2.305em -0.469em); top: -2.122em; left: 0.003em;"><span class="mi" id="MathJax-Span-157" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 2.128em;"></span></span><span style="position: absolute; top: -1.945em; left: 0.475em;"><span class="mi" id="MathJax-Span-158" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span style="display: inline-block; width: 0px; height: 2.128em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.128em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.361em; vertical-align: -0.425em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-6">\theta_j</script> come closer to the optimal values that will achieve the lowest cost <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-7-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-159" style="width: 2.364em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.951em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.243em 1000.003em 2.6em -0.469em); top: -2.181em; left: 0.003em;"><span class="mrow" id="MathJax-Span-160"><span class="mi" id="MathJax-Span-161" style="font-family: MathJax_Math; font-style: italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.062em;"></span></span><span class="mo" id="MathJax-Span-162" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-163" style="font-family: MathJax_Math; font-style: italic;">θ</span><span class="mo" id="MathJax-Span-164" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.187em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.361em; vertical-align: -0.354em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-7">J(\theta)</script>.</p>

<blockquote>
  <p>We store each example as a row in the the <code>X</code> matrix in Octave. To take into account the intercept term (<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-8-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-165" style="width: 1.183em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.997em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.245em 1000.003em 2.488em -0.494em); top: -2.109em; left: 0.003em;"><span class="mrow" id="MathJax-Span-166"><span class="msubsup" id="MathJax-Span-167"><span style="display: inline-block; position: relative; width: 0.935em; height: 0px;"><span style="position: absolute; clip: rect(1.245em 1000.003em 2.301em -0.494em); top: -2.109em; left: 0.003em;"><span class="mi" id="MathJax-Span-168" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 2.115em;"></span></span><span style="position: absolute; top: -1.984em; left: 0.5em;"><span class="texatom" id="MathJax-Span-169"><span class="mrow" id="MathJax-Span-170"><span class="mn" id="MathJax-Span-171" style="font-size: 70.7%; font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 2.115em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.115em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.146em; vertical-align: -0.282em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-8">\theta_{0}</script>), we add an additional first column to <code>X</code> and set it to all ones. This allows us to treat <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-9-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-172" style="width: 1.183em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.997em; height: 0px; font-size: 115%;"><span style="position: absolute; clip: rect(1.245em 1000.003em 2.488em -0.494em); top: -2.109em; left: 0.003em;"><span class="mrow" id="MathJax-Span-173"><span class="msubsup" id="MathJax-Span-174"><span style="display: inline-block; position: relative; width: 0.935em; height: 0px;"><span style="position: absolute; clip: rect(1.245em 1000.003em 2.301em -0.494em); top: -2.109em; left: 0.003em;"><span class="mi" id="MathJax-Span-175" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 2.115em;"></span></span><span style="position: absolute; top: -1.984em; left: 0.5em;"><span class="texatom" id="MathJax-Span-176"><span class="mrow" id="MathJax-Span-177"><span class="mn" id="MathJax-Span-178" style="font-size: 70.7%; font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 2.115em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.115em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.146em; vertical-align: -0.282em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-9">\theta_{0}</script> as simply another “feature”.</p>
</blockquote>

<h4 id="initialize-parameters">initialize parameters</h4>

<p>Add another dimension to accommodate the <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-10-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-179" style="width: 1.184em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.947em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.243em 1000.003em 2.482em -0.469em); top: -2.122em; left: 0.003em;"><span class="mrow" id="MathJax-Span-180"><span class="msubsup" id="MathJax-Span-181"><span style="display: inline-block; position: relative; width: 0.888em; height: 0px;"><span style="position: absolute; clip: rect(1.243em 1000.003em 2.305em -0.469em); top: -2.122em; left: 0.003em;"><span class="mi" id="MathJax-Span-182" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 2.128em;"></span></span><span style="position: absolute; top: -1.945em; left: 0.475em;"><span class="texatom" id="MathJax-Span-183"><span class="mrow" id="MathJax-Span-184"><span class="mn" id="MathJax-Span-185" style="font-size: 70.7%; font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 2.128em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.128em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.218em; vertical-align: -0.282em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-10">\theta_{0}</script> intercept term. Set initial parameters to 0 and learning rate <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-11-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-186" style="width: 0.829em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.652em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.538em 1000.003em 2.305em -0.469em); top: -2.122em; left: 0.003em;"><span class="mrow" id="MathJax-Span-187"><span class="mi" id="MathJax-Span-188" style="font-family: MathJax_Math; font-style: italic;">α</span></span><span style="display: inline-block; width: 0px; height: 2.128em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.718em; vertical-align: -0.068em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-11">\alpha</script> to 0.01.</p>

<pre class="prettyprint prettyprinted"><code class="language-matlab"><span class="pln">X </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[</span><span class="pln">ones</span><span class="pun">(</span><span class="pln">m</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">),</span><span class="pln"> data</span><span class="pun">(:,</span><span class="lit">1</span><span class="pun">)];</span><span class="pln">    </span><span class="pun">%</span><span class="pln"> </span><span class="typ">Add</span><span class="pln"> a column of ones to x
theta </span><span class="pun">=</span><span class="pln"> zeros</span><span class="pun">(</span><span class="lit">2</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">            </span><span class="pun">%</span><span class="pln"> initialize fitting parameters
iterations </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1500</span><span class="pun">;</span><span class="pln">
alpha </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0.01</span><span class="pun">;</span></code></pre>

<h4 id="compute-the-cost-jtheta">compute the cost <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-12-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-189" style="width: 2.39em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.977em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.334em 1000.002em 2.573em -0.365em); top: -2.202em; left: 0.002em;"><span class="mrow" id="MathJax-Span-190"><span class="mi" id="MathJax-Span-191" style="font-family: MathJax_Math; font-style: italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.094em;"></span></span><span class="mo" id="MathJax-Span-192" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-193" style="font-family: MathJax_Math; font-style: italic;">θ</span><span class="mo" id="MathJax-Span-194" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.206em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.336em; vertical-align: -0.331em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-12">J(\theta)</script></h4>

<pre class="prettyprint prettyprinted"><code class="language-matlab"><span class="pln">J </span><span class="pun">=</span><span class="pln"> sum</span><span class="pun">((</span><span class="pln">X </span><span class="pun">*</span><span class="pln"> theta </span><span class="pun">-</span><span class="pln"> y</span><span class="pun">)</span><span class="pln"> </span><span class="pun">.^</span><span class="pln"> </span><span class="lit">2</span><span class="pun">)</span><span class="pln"> </span><span class="pun">/</span><span class="pln"> </span><span class="pun">(</span><span class="lit">2</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> size</span><span class="pun">(</span><span class="pln">X</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">));</span><span class="pln">   </span><span class="pun">%</span><span class="pln"> </span><span class="typ">Compute</span><span class="pln"> cost </span><span class="kwd">for</span><span class="pln"> X </span><span class="kwd">and</span><span class="pln"> y </span><span class="kwd">with</span><span class="pln"> theta</span></code></pre>

<h3 id="224-gradient-descent">2.2.4 Gradient descent</h3>

<p>The cost <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-13-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-195" style="width: 2.364em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.951em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.243em 1000.003em 2.6em -0.469em); top: -2.181em; left: 0.003em;"><span class="mrow" id="MathJax-Span-196"><span class="mi" id="MathJax-Span-197" style="font-family: MathJax_Math; font-style: italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.062em;"></span></span><span class="mo" id="MathJax-Span-198" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-199" style="font-family: MathJax_Math; font-style: italic;">θ</span><span class="mo" id="MathJax-Span-200" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.187em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.361em; vertical-align: -0.354em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-13">J(\theta)</script> is parameterized by the vector <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-14-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-201" style="width: 0.593em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.475em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.243em 1000.003em 2.305em -0.469em); top: -2.122em; left: 0.003em;"><span class="mrow" id="MathJax-Span-202"><span class="mi" id="MathJax-Span-203" style="font-family: MathJax_Math; font-style: italic;">θ</span></span><span style="display: inline-block; width: 0px; height: 2.128em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.004em; vertical-align: -0.068em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-14">\theta</script>, not <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-15-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-204" style="width: 1.066em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.888em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.243em 1000.003em 2.305em -0.528em); top: -2.122em; left: 0.003em;"><span class="mrow" id="MathJax-Span-205"><span class="mi" id="MathJax-Span-206" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.128em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.004em; vertical-align: -0.068em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-15">X</script> and <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-16-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-207" style="width: 0.652em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.534em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.538em 1000.003em 2.482em -0.528em); top: -2.122em; left: 0.003em;"><span class="mrow" id="MathJax-Span-208"><span class="mi" id="MathJax-Span-209" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.128em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.932em; vertical-align: -0.282em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-16">y</script>. That is, we minimize the value of <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-17-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-210" style="width: 2.364em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.951em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.243em 1000.003em 2.6em -0.469em); top: -2.181em; left: 0.003em;"><span class="mrow" id="MathJax-Span-211"><span class="mi" id="MathJax-Span-212" style="font-family: MathJax_Math; font-style: italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.062em;"></span></span><span class="mo" id="MathJax-Span-213" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-214" style="font-family: MathJax_Math; font-style: italic;">θ</span><span class="mo" id="MathJax-Span-215" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.187em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.361em; vertical-align: -0.354em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-17">J(\theta)</script> by changing the values of the vector <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-18-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-216" style="width: 0.593em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.475em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.243em 1000.003em 2.305em -0.469em); top: -2.122em; left: 0.003em;"><span class="mrow" id="MathJax-Span-217"><span class="mi" id="MathJax-Span-218" style="font-family: MathJax_Math; font-style: italic;">θ</span></span><span style="display: inline-block; width: 0px; height: 2.128em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.004em; vertical-align: -0.068em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-18">\theta</script>, not by changing <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-19-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-219" style="width: 1.066em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.888em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.243em 1000.003em 2.305em -0.528em); top: -2.122em; left: 0.003em;"><span class="mrow" id="MathJax-Span-220"><span class="mi" id="MathJax-Span-221" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.128em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.004em; vertical-align: -0.068em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-19">X</script> or <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-20-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-222" style="width: 0.652em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.534em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.538em 1000.003em 2.482em -0.528em); top: -2.122em; left: 0.003em;"><span class="mrow" id="MathJax-Span-223"><span class="mi" id="MathJax-Span-224" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.128em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.932em; vertical-align: -0.282em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-20">y</script>.</p>

<pre class="prettyprint prettyprinted"><code class="language-matlab"><span class="kwd">function</span><span class="pln"> </span><span class="pun">[</span><span class="pln">theta</span><span class="pun">,</span><span class="pln"> J_history</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> gradientDescent</span><span class="pun">(</span><span class="pln">X</span><span class="pun">,</span><span class="pln"> y</span><span class="pun">,</span><span class="pln"> theta</span><span class="pun">,</span><span class="pln"> alpha</span><span class="pun">,</span><span class="pln"> num_iters</span><span class="pun">)</span><span class="pln">
</span><span class="pun">%</span><span class="pln">GRADIENTDESCENT </span><span class="typ">Performs</span><span class="pln"> gradient descent to learn theta
</span><span class="pun">%</span><span class="pln">   theta </span><span class="pun">=</span><span class="pln"> GRADIENTDESENT</span><span class="pun">(</span><span class="pln">X</span><span class="pun">,</span><span class="pln"> y</span><span class="pun">,</span><span class="pln"> theta</span><span class="pun">,</span><span class="pln"> alpha</span><span class="pun">,</span><span class="pln"> num_iters</span><span class="pun">)</span><span class="pln"> updates theta </span><span class="kwd">by</span><span class="pln"> 
</span><span class="pun">%</span><span class="pln">   taking num_iters gradient steps </span><span class="kwd">with</span><span class="pln"> learning rate alpha

</span><span class="pun">%</span><span class="pln"> </span><span class="typ">Initialize</span><span class="pln"> some useful values
m </span><span class="pun">=</span><span class="pln"> length</span><span class="pun">(</span><span class="pln">y</span><span class="pun">);</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> number of training examples
J_history </span><span class="pun">=</span><span class="pln"> zeros</span><span class="pun">(</span><span class="pln">num_iters</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">

</span><span class="kwd">for</span><span class="pln"> iter </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">:</span><span class="pln">num_iters

    </span><span class="pun">%</span><span class="pln"> </span><span class="pun">======================</span><span class="pln"> YOUR CODE HERE </span><span class="pun">======================</span><span class="pln">

    theta </span><span class="pun">=</span><span class="pln"> theta </span><span class="pun">-</span><span class="pln"> alpha </span><span class="pun">/</span><span class="pln"> m </span><span class="pun">*</span><span class="pln"> </span><span class="pun">((</span><span class="pln">X </span><span class="pun">*</span><span class="pln"> theta </span><span class="pun">-</span><span class="pln"> y</span><span class="pun">)</span><span class="str">' * X)'</span><span class="pun">;</span><span class="pln">

    </span><span class="pun">%</span><span class="pln"> </span><span class="pun">============================================================</span><span class="pln">

    </span><span class="pun">%</span><span class="pln"> </span><span class="typ">Save</span><span class="pln"> the cost J </span><span class="kwd">in</span><span class="pln"> every iteration    
    J_history</span><span class="pun">(</span><span class="pln">iter</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> computeCost</span><span class="pun">(</span><span class="pln">X</span><span class="pun">,</span><span class="pln"> y</span><span class="pun">,</span><span class="pln"> theta</span><span class="pun">);</span><span class="pln">

</span><span class="kwd">end</span><span class="pln">

</span><span class="kwd">end</span></code></pre>

<h3 id="visualizing-jtheta">Visualizing <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-21-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-225" style="width: 2.309em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.896em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.31em 1000.002em 2.515em -0.239em); top: -2.168em; left: 0.002em;"><span class="mrow" id="MathJax-Span-226"><span class="mi" id="MathJax-Span-227" style="font-family: MathJax_Math; font-style: italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.071em;"></span></span><span class="mo" id="MathJax-Span-228" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-229" style="font-family: MathJax_Math; font-style: italic;">θ</span><span class="mo" id="MathJax-Span-230" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.171em;"></span></span></span><span style="border-left-width: 0.002em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.294em; vertical-align: -0.331em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-21">J(\theta)</script></h3>

<pre class="prettyprint prettyprinted"><code class="language-matlab"><span class="pun">%</span><span class="pln"> initialize J_vals to a matrix of </span><span class="lit">0</span><span class="str">'s
J_vals = zeros(length(theta0_vals), length(theta1_vals));

% Fill out J_vals
for i = 1:length(theta0_vals)
    for j = 1:length(theta1_vals)
      t = [theta0_vals(i); theta1_vals(j)];    
      J_vals(i,j) = computeCost(X, y, t);
    end
end</span></code></pre></div></body>
</html>
